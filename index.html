<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>HTML5 Barrage Player</title>
	<link rel="stylesheet" href="style/style.css">
</head>

<body>
	<header>
		<h3>HTML5 Barrage Player</h3>
	</header>

	<div class="container">
		<div class="container-left">
			<video id="video-main" src="ly.mp4" type="video/mp4" controls>
				Your browser dosen't support HTML5 Video
			</video>
			<div class="container-bottom">
				<div class="video-bottom-left">输入弹幕:</div>
				<input type="text" placeholder="蛤蛤蛤蛤蛤蛤蛤蛤" />
				<input type="button" value="发送">
			</div>
			<div class="barrage">哈哈哈哈哈哈哈hhhhhhh哈哈</div>
		</div>
		<div class="container-right">
			<div class="right-top">
				<div class="right-top-left">
					<span>弹幕:233</span>
					<br/><span>观众:23333</span>
					<br/><span>播放:233</span>
				</div>
				<div class="right-top-right">
					<span>预留地</span>
				</div>
			</div>
			<div class="right-bottom">
				<div class="right-bottom-top">
					<ul>
						<li id="video-time">时间</li>
						<li id="comment">评论</li>
						<li id="send-time">发送时间</li>
					</ul>
				</div>
				<div class="right-bottom-list">ffddf</div>
			</div>
		</div>
	</div>

	<footer>
		<h5><span>Powered by <a href="http://ivydom.com" target="_blank">ivydom.com</a></span></h5>
	</footer>
	<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
	<script type="text/javascript">
		$(document).ready(function(){

      		//添加动画效果
      		$('h3,h5 span,.right-bottom-top ul li,input').hover(
        		function(){$(this).stop().animate({opacity:0.6},400);},
        		function(){$(this).stop().animate({opacity:1},400);}
      		);

      		var media=document.getElementById("video-main");
      		var duration=media.duration;
      		var startTime=media.startTime;
      		var currentTime;
      		var timeRemaining;

      		var eventListener=function(e){
       			media.addEventListener(e,function(){
           			switch(e){
           				case 'play':
           					var itemLeft=$('.barrage').css('left').split('px')[0];
           					var videoWidth=$('.container').css('width').split('px')[0];
           					var charFontSize=$('.barrage').css('fontSize').split('px')[0];
           					var charLength=($('.barrage').html().length)*charFontSize;
           					var endPos=videoWidth-itemLeft-charLength;
           					$('.barrage').animate({
           						left:endPos+'px'
           					},
           					5500);
           					break;
           				default:
           					break;
           			}
       			});
   			}

   			//监视现在播放进度和剩余时间
			media.addEventListener("timeupdate",function(){ 
  				var vTime=media.currentTime;
  				currentTime=vTime.toFixed(1);
  				timeRemaining=(duration-vTime).toFixed(1);
  				console.log(currentTime,timeRemaining);
			}, false);

      		eventListener('play');
      		eventListener('pause');
      		eventListener('timeupdate');
      		eventListener('ended');
      		
		});
	</script>
</body>
</html>